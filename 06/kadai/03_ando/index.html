<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>p5play</title>
    <style>
      canvas {
        border: 1px solid #aaa;
      }
    </style>
  </head>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.11.4/lib/p5.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.11.4/lib/addons/p5.sound.min.js"></script>
    <!-- planck -->
    <script src="https://cdn.jsdelivr.net/npm/planck@latest/dist/planck.min.js"></script>
    <!-- Version 3 of p5.play -->
    <script src="https://p5play.org/v3/p5play.js"></script>
    <script>
let player, floor;
let enemies;
let isGameOver = false;
let playerImg;
let enemyImg;

function preload() {
  playerImg = loadImage('player.png');
  enemyImg = loadImage('maguro.svg');
}

function setup() {
  createCanvas(640, 480);
  world.gravity.y = 10;

  floor = new Sprite(320, 400, 500, 30);
  floor.color = '#666';
  floor.collider = 'static';

  player = new Sprite(100, 100);
  player.image = playerImg;
  player.scale = 0.04;

enemies = new Group();
enemies.image = enemyImg;
enemies.collider = 'kunematic';
enemies.scale = 0.1;
}

function draw() {
  background(255);

  if (isGameOver) {
    fill(0);
    textSize(50);
    textAlign(CENTER);
    text('GAME OVER', width / 2, height / 2);
    return;
  }

  if (kb.pressing('right')) {
    player.vel.x = 5;
  } else if (kb.pressing('left')) {
    player.vel.x = -5;
  } else {
    player.vel.x = 0;
  }

  if (kb.presses('up') && player.colliding(floor)) {
    player.vel.y = -5;
  }

  if (frameCount % 120 === 0) {
              let side = int(random(4)); // 0: left, 1: right, 2: top, 3: bottom
    let enemy;

    if (side === 0) {
      enemy = new enemies.Sprite(-50, random(0, height));
      enemy.vel.x = random(2, 5);
    } else if (side === 1) {
      enemy = new enemies.Sprite(width + 50, random(0, height));
      enemy.vel.x = random(-5, -2);
    } else if (side === 2) {
      enemy = new enemies.Sprite(random(0, width), -50);
      enemy.vel.y = random(2, 5);
    } else if (side === 3) {
      enemy = new enemies.Sprite(random(0, width), height + 50);
      enemy.vel.y = random(-5, -2);
    }
  }

  enemies.cull(100);

  if (player.collides(enemies)) {
    player.maxSpeed = 25;
    player.vel.x *= 2.5;
  }
}
 </script>
  </body>
</html>