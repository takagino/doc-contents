<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>p5.js</title>
    <style>
      canvas {
        border: 1px solid #aaa;
      }
    </style>
  </head>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.11.11/lib/p5.min.js"></script>
    <script>
      let balls = []; // 複数のBallインスタンスを格納する配列
      const NUM_BALLS = 10; // 生成するボールの数

      function setup() {
        createCanvas(640, 480);
        colorMode(HSL);
        rectMode(CENTER);
        angleMode(DEGREES);
        fill(0, 80, 70);
        noStroke();

        // 指定した数だけBallインスタンスを生成し、配列に追加
        for (let i = 0; i < NUM_BALLS; i++) {
          balls.push(new Ball());
        }
      }

      function draw() {
        background(0, 0.1); // 残像効果

        // 配列内のすべてのボールに対して処理を実行
        for (let ball of balls) {
          ball.update(); // 座標を更新
          ball.draw(); // 描画
        }
      }

      function mouseReleased() {
        balls.push(new Ball());
      }

      class Ball {
        constructor(
          startX = width / 2,
          startY = height / 2,
          size = random(10, 30),
          color = [random(360), 80, 70]
        ) {
          this.x = startX;
          this.y = startY;
          this.size = size;
          this.color = color;
          this.xOffset = random(0, 1000);
          this.yOffset = random(1000, 2000);
        }

        update() {
          this.x = noise(this.xOffset) * width;
          this.y = noise(this.yOffset) * height;

          this.xOffset += 0.005;
          this.yOffset += 0.005;
        }

        draw() {
          fill(this.color);
          ellipse(this.x, this.y, this.size, this.size);
        }
      }
    </script>
  </body>
</html>
