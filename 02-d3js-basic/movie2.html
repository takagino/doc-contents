<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2024年映画興行収入ランキング</title>
  <style>
    body {
      margin: 0;
      background-color: #eee;
    }

    #chart svg {
      display: block;
      width: 80%;
      height: auto;
      margin: auto;
    }

    h1 {
      text-align: center;
    }
  </style>
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
  <h1>2024年映画興行収入ランキング</h1>
  <div id="chart"></div>

  <script>
    const dataset = [
      {
        label: '名探偵コナン 100万ドルの五稜星（みちしるべ）',
        value: 158,
        url: 'https://pixiin.com/img/1299-s2.jpg',
      },
      {
        label: '劇場版ハイキュー!! ゴミ捨て場の決戦',
        value: 116,
        url: 'https://pixiin.com/img/1235-s2.jpg',
      },
      {
        label: 'キングダム 大将軍の帰還',
        value: 80,
        url: 'https://pixiin.com/img/1307-s2.jpg',
      },
      {
        label: 'はたらく細胞',
        value: 63,
        url: 'https://pixiin.com/img/2896-s2.jpg',
      },
      {
        label: 'ラストマイル',
        value: 59,
        url: 'https://pixiin.com/img/2819-s2.jpg',
      },
      {
        label: '機動戦士ガンダムSEED FREEDOM',
        value: 53,
        url: 'https://pixiin.com/img/1226-s2.jpg',
      },
      {
        label: 'インサイド・ヘッド2',
        value: 53,
        url: 'https://pixiin.com/img/1315-s2.jpg',
      },
      {
        label: 'モアナと伝説の海21',
        value: 51,
        url: '',
      },
      {
        label: '変な家',
        value: 50,
        url: 'https://pixiin.com/img/1339-s2.jpg',
      },
      {
        label: '怪盗グルーのミニオン超変身',
        value: 45,
        url: '',
      },
    ];

    const xScale = d3
      .scaleLinear()
      .domain([0, 158])
      .range([0, 500 - 100]);

    const svg = d3
      .select('#chart')
      .append('svg')
      .attr('viewBox', '0 0 500 300');

    svg
      .selectAll('image')
      .data(dataset)
      .join('image')
      .attr('href', (d) => d.url)
      .attr('x', 0)
      .attr('y', (d, i) => i * 30)
      .attr('width', 30);

    svg
      .selectAll('rect')
      .data(dataset)
      .join('rect')
      .attr('x', 40)
      .attr('y', (d, i) => i * 30 + 10)
      .attr('width', (d) => xScale(d.value))
      .attr('height', 10)
      .attr('fill', (d, i) => {
        if (i == 0) {
          return '#f00'
        } else {
          return '#ff0'
        }
      });

    svg
      .selectAll('.label')
      .data(dataset)
      .join('text')
      .classed('label', true)
      .attr('font-size', '10')
      .attr('x', 40)
      .attr('y', (d, i) => i * 30 + 10)
      .attr('fill', '#f00')
      .text((d, i) => `${i + 1}位：${d.label}`);

    svg
      .selectAll('.value')
      .data(dataset)
      .join('text')
      .classed('value', true)
      .attr('font-size', '8')
      .attr('x', (d) => xScale(d.value) + 40)
      .attr('y', (d, i) => i * 30 + 20)
      .text((d) => `${d.value}億円`);
  </script>
</body>
</html>
